{% extends 'base.html' %}

{% block title %}Paramètres{% endblock title %}

{% set max_file_size = settings.max_file_size %}
{% set allowed_extensions = settings.allowed_extensions %}
{% set delete_after = settings.duration_days %}
{% set keep_files = settings.keep_files %}

{% block content %}
  <form action="" method="post" class="flex flex-col gap-5 p-8">
    <div>
        <h2 class="text-lg font-bold mb-3 text-gray-900 dark:text-gray-300 ">Taille maximale des fichiers</h2>
        <ul class="grid w-full gap-6 grid-cols-1 md:grid-cols-{{ settings.authorized_max_size|length // 3 }} lg:grid-cols-{{ settings.authorized_max_size|length // 2 }}">
            {% for size in settings.authorized_max_size %}
                <li class="h-max">
                    <input type="radio" id="{{ size.label }}" name="hosting" value="{{ size.value }}" class="hidden peer" required {% if size.value == max_file_size %}checked{% endif %}>
                    <label for="{{ size.label }}" class="inline-flex items-center justify-between w-full p-5 text-gray-500 bg-white border border-gray-200 rounded-lg cursor-pointer dark:hover:text-gray-300 dark:border-gray-700 dark:peer-checked:text-purple-500 peer-checked:border-purple-600 peer-checked:text-purple-600 hover:text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:bg-gray-800 dark:hover:bg-gray-700">                           
                        <div class="block">
                            <div class="w-full text-lg font-semibold">{{ size.label }}</div>
                        </div>
                    </label>
                </li>
            {% endfor %}
        </ul>

    </div>
    <div>
        <h2 class="text-lg font-bold mb-3 text-gray-900 dark:text-gray-300">Extensions autorisées</h2>        
        <ul class="grid w-full gap-6 grid-cols-2 md:grid-cols-{{ [settings.authorized_extensions|length // 3, 6]|min }} lg:grid-cols-{{ [settings.authorized_extensions|length // 2, 10]|min }}">
            {% for extension in settings.authorized_extensions %}
                <li>
                    <input type="checkbox" name="allowed_extensions" id="{{ extension }}" value="{{ extension }}" class="hidden peer" required />
                    <label for="{{ extension }}" class="inline-flex items-center justify-center w-full p-5 text-gray-500 bg-white border-2 border-gray-200 rounded-lg cursor-pointer dark:hover:text-gray-300 dark:border-gray-700 peer-checked:border-purple-600 hover:text-gray-600 dark:peer-checked:text-gray-300 peer-checked:text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:bg-gray-800 dark:hover:bg-gray-700">                           
                        <div class="w-full text-sm text-center"> {{ extension }} </div>
                    </label>
                </li>
            {% endfor %}
        </ul>
        
    </div>
    <div>
        <label for="duration_days" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Supprimer les fichiers après (en jours)</label>
        <input id="duration_days" name="duration_days" type="range" min="0" max="30" value="{{ delete_after }}" step="1" class="w-full h-2 bg-gray-50 rounded-lg appearance-none cursor-pointer dark:bg-gray-700">

    </div>
    <div class="flex justify-between gap-3">
        <label for="keep_files" class="text-sm font-medium text-gray-900 dark:text-gray-300">Conserver les fichiers commençant par</label>
        <input class="form-control" type="text" name="keep_files" id="keep_files" value="{{ keep_files }}" required>
    </div>
    <input type="submit" value="Enregistrer les paramètres" class="mt-3 focus:outline-none text-white bg-purple-700 hover:cursor-pointer hover:bg-purple-800 focus:ring-4 focus:ring-purple-300 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 dark:bg-purple-600 dark:hover:bg-purple-700 dark:focus:ring-purple-900">
  </form>
{% endblock content %}
